<!-- This is a static file -->
<!-- served from your routes in server.js -->

<!DOCTYPE html>
<html>
  <head>
    <title>My p5 thing.</title>
    <meta name="description" content="p5.js CDN Template" />
    <link
      href="https://unpkg.com/@pqina/flip/dist/flip.min.css"
      rel="stylesheet"
    />
    <script src="https://unpkg.com/@pqina/flip/dist/flip.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/p5@1.3.0/lib/p5.js"></script>
    <!--script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.6.0/addons/p5.dom.js"></script-->
    <!--script src="/sketch.js"></script-->
  </head>
  <body>
    <style>
      .tick {
        font-size: 1rem;
        white-space: nowrap;
        font-family: arial, sans-serif;
      }

      .tick-flip,
      .tick-text-inline {
        font-size: 2.5em;
      }

      .tick-label {
        margin-top: 1em;
        font-size: 1em;
      }

      .tick-char {
        width: 1.5em;
      }

      .tick-text-inline {
        display: inline-block;
        text-align: center;
        min-width: 1em;
      }

      .tick-text-inline + .tick-text-inline {
        margin-left: -0.325em;
      }

      .tick-group {
        margin: 0 0.5em;
        text-align: center;
      }

      body {
        background-color: rgb(255, 255, 255) !important;
      }

      .tick-text-inline {
        color: rgb(90, 93, 99) !important;
      }

      .tick-label {
        color: rgb(90, 93, 99) !important;
      }

      .tick-flip-panel {
        color: rgb(255, 255, 255) !important;
      }

      .tick-flip {
        font-family: !important;
      }

      .tick-flip-panel-text-wrapper {
        line-height: 1.45 !important;
      }

      .tick-flip-panel {
        background-color: rgb(159, 61, 59) !important;
        background-image: url("http://commons.wikimedia.org/wiki/Special:FilePath/Loxia%20curvirostra%20-Karwendel%20mountains%2C%20Austria.jpg");
        background-size: cover;
      }

      .tick-flip {
        border-radius: 0.12em !important;
      }
    </style>

    <div class="tick" data-did-init="handleTickInit">
      <div data-layout="horizontal fit">
        <span data-key="hours" data-transform="pad(00)" data-view="flip"></span>

        <span data-view="text" data-key="sep" class="tick-text-inline"></span>

        <span
          data-key="minutes"
          data-transform="pad(00)"
          data-view="flip"
        ></span>

        <span data-view="text" data-key="sep" class="tick-text-inline"></span>

        <span
          data-key="seconds"
          data-transform="pad(00)"
          data-view="flip"
        ></span>
      </div>
    </div>
    <script>
      function handleTickInit(tick) {
        // start interval (default is 1 second) and update clock with current time
        Tick.helper.interval(function () {
          var d = Tick.helper.date();
          tick.value = {
            sep: ".",
            hours: d.getHours(),
            minutes: d.getMinutes(),
            seconds: d.getSeconds(),
          };
        });
      }
    </script>

    <script>
      var lastTime = new Date(0);
      function changeTime() {
        var now = new Date();
        if (now.getHours() != lastTime.getHours()) {
          fetch("/birdNum?num=" + now.getHours()) // Call the fetch function passing the url of the API as a parameter
            .then(function (response) {
              response.text().then(function (text) {
                try {
                  var bj = JSON.parse(text);
                  document.getElementById("hour").innerHTML =
                    bj.howMany + " " + bj.comName;
                } catch (e) {}
              });
            })
            .catch(function () {});
        }
        if (now.getMinutes() != lastTime.getMinutes()) {
          fetch("/birdNum?num=" + now.getMinutes()) // Call the fetch function passing the url of the API as a parameter
            .then(function (response) {
              response.text().then(function (text) {
                try {
                  var bj = JSON.parse(text);
                  document.getElementById("min").innerHTML =
                    bj.howMany + " " + bj.comName;
                } catch (e) {}
              });
            })
            .catch(function () {});
        }
        if (now.getSeconds() != lastTime.getSeconds()) {
          fetch("/birdNum?num=" + now.getSeconds()) // Call the fetch function passing the url of the API as a parameter
            .then(function (response) {
              response.text().then(function (text) {
                try {
                  var bj = JSON.parse(text);
                  console.log(bj);
                  document.getElementById("sec").innerHTML =
                    bj.howMany +
                    " " +
                    bj.comName +
                    "<img src='" +
                    bj.image +
                    "'>";
                } catch (e) {}
              });
            })
            .catch(function () {});
        }
        lastTime = now;
      }

      setInterval(changeTime, 1000);
    </script>
  </body>
</html>
